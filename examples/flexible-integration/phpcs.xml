<?xml version="1.0"?>
<ruleset name="Project Standards with Flexible Security">
    <description>Project with customized security rules</description>

    <!-- Your existing project rules -->
    <rule ref="PSR12"/>
    
    <!-- Add flexible security standards -->
    <rule ref="CommonSecurity/Flexible"/>
    
    <!-- Project-specific security exclusions -->
    <!-- Example: Allow unserialize for this specific project -->
    <rule ref="Generic.PHP.ForbiddenFunctions">
        <exclude-pattern>*/src/LegacyDataHandler.php</exclude-pattern>
        <properties>
            <property name="forbiddenFunctions" type="array">
                <!-- Remove unserialize from forbidden list for this project -->
                <!-- <element key="unserialize" value="..."/> -->
            </property>
        </properties>
    </rule>
    
    <!-- Allow mail() function in specific files -->
    <rule ref="Generic.PHP.ForbiddenFunctions.Found">
        <exclude-pattern>*/src/EmailService.php</exclude-pattern>
        <exclude-pattern>*/src/NotificationHandler.php</exclude-pattern>
    </rule>
    
    <file>.</file>
    <exclude-pattern>*/vendor/*</exclude-pattern>
    
</ruleset>
